}
}
warnings()
general_life_table_list_bl <- list()
index <- 1
for (age in i_age_cohort){
for (sex in i_sex){
# cat("age ", age, " and sex ", sex, "\n") #Uncomment to see index
general_life_table_list_bl[[index]] <- RunLifeTable(in_idata = mslt_df,
in_sex = sex, in_mid_age = age)
# names(general_life_table_list_bl)[index] <- paste(iage, isex, sep = "_")
index <- index + 1
}
}
general_life_table_list_bl <- list()
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
# cat("age ", age, " and sex ", sex, "\n") #Uncomment to see index
general_life_table_list_bl[[index]] <- RunLifeTable(in_idata = mslt_df,
in_sex = isex, in_mid_age = iage)
# names(general_life_table_list_bl)[index] <- paste(iage, isex, sep = "_")
index <- index + 1
}
}
warnings
warnings()
View(general_life_table_list_bl[[1]])
general_life_table_list_bl <- list()
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
# cat("age ", age, " and sex ", sex, "\n") #Uncomment to see index
general_life_table_list_bl[[index]] <- RunLifeTable(in_idata = mslt_df,
in_sex = isex, in_mid_age = iage)
names(general_life_table_list_bl)[index] <- paste(iage, isex, sep = "_")
index <- index + 1
}
}
View(general_life_table_list_bl)
disease_life_table_list_bl <- list()
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
for (d in 1:nrow(disease_short_names)){
# Exclude non-males diseases
if ((isex == "male" && disease_short_names$disease[d] == "breast cancer") || (isex == "male" && disease_short_names$disease[d] == "uterine cancer")) {
}
## Exclude non-chronic diseases and road injuries and disease with no pif
if (disease_short_names$is_not_dis[d] != 0 || disease_short_names$acronym[d] == "no_pif" || disease_short_names$acronym[d] == "other"){
}
else {
disease_life_table_list_bl[[index]] <- RunDisease(in_idata = mslt_df, in_sex = isex, in_mid_age = iage, in_disease = disease_short_names$sname[d])
names(disease_life_table_list_bl)[index] <- paste(iage, isex, disease_short_names$sname[d], sep = "_")
index <- index + 1
}
}
}
}
View(disease_life_table_list_bl)
View(disease_life_table_list_bl)
disease_short_names$disease
disease_life_table_list_bl <- list()
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
for (d in 1:nrow(disease_short_names)){
# Exclude non-males diseases
if (isex == "male" & (disease_short_names$disease[d] %in% c("breast cancer", "uterine cancer"))) {
}
## Exclude non-chronic diseases and road injuries and disease with no pif
if (disease_short_names$is_not_dis[d] != 0 || disease_short_names$acronym[d] == "no_pif" || disease_short_names$acronym[d] == "other"){
}
else {
disease_life_table_list_bl[[index]] <- RunDisease(in_idata = mslt_df, in_sex = isex, in_mid_age = iage, in_disease = disease_short_names$sname[d])
names(disease_life_table_list_bl)[index] <- paste(iage, isex, disease_short_names$sname[d], sep = "_")
index <- index + 1
}
}
}
}
Q
disease_life_table_list_bl <- list()
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
for (d in 1:nrow(disease_short_names)){
## Exclude non-males diseases and non-chronic diseases and road injuries and disease with no pif
if (isex == "male" && (disease_short_names$disease[d] %in% c("breast cancer", "uterine cancer"))
|| disease_short_names$is_not_dis[d] != 0 || disease_short_names$acronym[d] == "no_pif" || disease_short_names$acronym[d] == "other"){
}
else {
print(paste(isex, disease_short_names$disease[d]))
# disease_life_table_list_bl[[index]] <- RunDisease(in_idata = mslt_df, in_sex = isex, in_mid_age = iage, in_disease = disease_short_names$sname[d])
# names(disease_life_table_list_bl)[index] <- paste(iage, isex, disease_short_names$sname[d], sep = "_")
#
# index <- index + 1
}
}
}
}
disease_life_table_list_bl <- list()
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
for (d in 1:nrow(disease_short_names)){
## Exclude non-males diseases and non-chronic diseases and road injuries and disease with no pif
if (isex == "male" && (disease_short_names$disease[d] %in% c("breast cancer", "uterine cancer"))
|| disease_short_names$is_not_dis[d] != 0 || disease_short_names$acronym[d] == "no_pif" || disease_short_names$acronym[d] == "other"){
}
else {
# print(paste(isex, disease_short_names$disease[d]))
disease_life_table_list_bl[[index]] <- RunDisease(in_idata = mslt_df, in_sex = isex, in_mid_age = iage, in_disease = disease_short_names$sname[d])
names(disease_life_table_list_bl)[index] <- paste(iage, isex, disease_short_names$sname[d], sep = "_")
index <- index + 1
}
}
}
}
View(disease_life_table_list_bl)
pifs_no_disease_deaths <- list()
index <- 1
for (iage in i_age_cohort) {
for (isex in i_sex) {
for (d in 1:nrow(disease_short_names)){
## Exclude chronic disease and all-cause mortality and  pyld
if (disease_short_names$is_not_dis[d] != 1 || disease_short_names$acronym[d] == "other") {
}
else {
var_name_deaths <- paste0("pif_", disease_short_names$acronym[d], "_", "deaths")
pifs_no_disease_deaths[[index]] <- GetPif(pif, iage, isex, var_name_deaths)
pifs_no_disease_deaths[[index]]$sex <- sex
pifs_no_disease_deaths[[index]]$deaths <- var_name_deaths
names(pifs_no_disease_deaths[[index]])[names(pifs_no_disease_deaths[[index]]) == var_name_deaths] <- "pif"
index <- index + 1
}
}
}
}
pifs_no_disease_ylds <- list()
index <- 1
for (iage in i_age_cohort) {
for (isex in i_sex) {
for (d in 1:nrow(disease_short_names)){
## Exclude chronic disease and all-cause mortality and  pyld
if (disease_short_names$is_not_dis[d] != 1 || disease_short_names$acronym[d] == "other") {
}
else {
var_name_ylds<- paste0("pif_", disease_short_names$acronym[d], "_", "ylds")
pifs_no_disease_ylds[[index]] <- GetPif(pif, iage, isex, var_name_ylds)
pifs_no_disease_ylds[[index]]$sex <- sex
pifs_no_disease_ylds[[index]]$deaths <- var_name_ylds
names(pifs_no_disease_ylds[[index]])[names(pifs_no_disease_ylds[[index]]) == var_name_ylds] <- "pif"
index <- index + 1
}
}
}
}
### Run non-disease life tables
non_disease_list <- list()
index <- 1
for (iage in i_age_cohort) {
for (isex in i_sex) {
for (d in 1:nrow(disease_short_names)){
## Exclude chronic disease and all-cause mortality and  pyld
if (disease_short_names$is_not_dis[d] != 1 || disease_short_names$acronym[d] == "other") {
}
else {
non_disease_list[[index]] <-  RunNonDisease (mslt_df, in_sex = isex, in_mid_age = iage, in_non_disease = disease_short_names$acronym[d])
## deaths sceanario
non_disease_list[[index]][paste0("deaths_rate_sc_", disease_short_names$acronym[d])] <-
non_disease_list[[index]][paste0("deaths_rate_", disease_short_names$acronym[d])] * (1 - pifs_no_disease_deaths[[index]]$pif)
## ylds scenario
non_disease_list[[index]][paste0("ylds_rate_sc_", disease_short_names$acronym[d])] <-
non_disease_list[[index]][paste0("ylds_rate_", disease_short_names$acronym[d])] * (1 - pifs_no_disease_ylds[[index]]$pif)
## Difference variable
## deaths difference
non_disease_list[[index]][paste0("deaths_rate_diff_", disease_short_names$acronym[d])] <- non_disease_list[[index]][paste0("deaths_rate_", disease_short_names$acronym[d])] -
non_disease_list[[index]][paste0("deaths_rate_sc_", disease_short_names$acronym[d])]
## ylds difference
non_disease_list[[index]][paste0("ylds_rate_diff_", disease_short_names$acronym[d])] <- non_disease_list[[index]][paste0("ylds_rate_", disease_short_names$acronym[d])] -
non_disease_list[[index]][paste0("ylds_rate_sc_", disease_short_names$acronym[d])]
names(non_disease_list)[index] <- paste(iage, isex, disease_short_names$acronym[d], sep = "_")
index <- index + 1
}
}
}
}
Q
names(mslt_df)[names(mslt_df) == "deaths_rate_pdri"] <- "deaths_rate_pedestrian"
names(mslt_df)[names(mslt_df) == "ylds (years lived with disability)_rate_pdri"] <- "ylds_rate_pedestrian"
names(mslt_df)[names(mslt_df) == "deaths_rate_cyri"] <- "deaths_rate_cyclist"
names(mslt_df)[names(mslt_df) == "ylds (years lived with disability)_rate_cyri"] <- "ylds_rate_cyclist"
names(mslt_df)[names(mslt_df) == "deaths_rate_mtri"] <- "deaths_rate_motorcyclist"
names(mslt_df)[names(mslt_df) == "ylds (years lived with disability)_rate_mtri"] <- "ylds_rate_motorcyclist"
names(mslt_df)[names(mslt_df) == "deaths_rate_mvri"] <- "deaths_rate_motor"
names(mslt_df)[names(mslt_df) == "ylds (years lived with disability)_rate_mvri"] <- "ylds_rate_motor"
names(mslt_df)[names(mslt_df) == "deaths_rate_otri"] <- "deaths_rate_other"
names(mslt_df)[names(mslt_df) == "ylds (years lived with disability)_rate_otri"] <- "ylds_rate_other"
names(mslt_df)[names(mslt_df) == "deaths_rate_lwri"] <- "deaths_rate_lri"
names(mslt_df)[names(mslt_df) == "ylds (years lived with disability)_rate_lwri"] <- "ylds_rate_lri"
write_csv(mslt_df, ("data/mslt_df.csv"))
pifs_no_disease_deaths <- list()
index <- 1
for (iage in i_age_cohort) {
for (isex in i_sex) {
for (d in 1:nrow(disease_short_names)){
## Exclude chronic disease and all-cause mortality and  pyld
if (disease_short_names$is_not_dis[d] != 1 || disease_short_names$acronym[d] == "other") {
}
else {
var_name_deaths <- paste0("pif_", disease_short_names$acronym[d], "_", "deaths")
pifs_no_disease_deaths[[index]] <- GetPif(pif, iage, isex, var_name_deaths)
pifs_no_disease_deaths[[index]]$sex <- sex
pifs_no_disease_deaths[[index]]$deaths <- var_name_deaths
names(pifs_no_disease_deaths[[index]])[names(pifs_no_disease_deaths[[index]]) == var_name_deaths] <- "pif"
index <- index + 1
}
}
}
}
pifs_no_disease_ylds <- list()
index <- 1
for (iage in i_age_cohort) {
for (isex in i_sex) {
for (d in 1:nrow(disease_short_names)){
## Exclude chronic disease and all-cause mortality and  pyld
if (disease_short_names$is_not_dis[d] != 1 || disease_short_names$acronym[d] == "other") {
}
else {
var_name_ylds<- paste0("pif_", disease_short_names$acronym[d], "_", "ylds")
pifs_no_disease_ylds[[index]] <- GetPif(pif, iage, isex, var_name_ylds)
pifs_no_disease_ylds[[index]]$sex <- sex
pifs_no_disease_ylds[[index]]$deaths <- var_name_ylds
names(pifs_no_disease_ylds[[index]])[names(pifs_no_disease_ylds[[index]]) == var_name_ylds] <- "pif"
index <- index + 1
}
}
}
}
### Run non-disease life tables
non_disease_list <- list()
index <- 1
for (iage in i_age_cohort) {
for (isex in i_sex) {
for (d in 1:nrow(disease_short_names)){
## Exclude chronic disease and all-cause mortality and  pyld
if (disease_short_names$is_not_dis[d] != 1 || disease_short_names$acronym[d] == "other") {
}
else {
non_disease_list[[index]] <-  RunNonDisease (mslt_df, in_sex = isex, in_mid_age = iage, in_non_disease = disease_short_names$acronym[d])
## deaths sceanario
non_disease_list[[index]][paste0("deaths_rate_sc_", disease_short_names$acronym[d])] <-
non_disease_list[[index]][paste0("deaths_rate_", disease_short_names$acronym[d])] * (1 - pifs_no_disease_deaths[[index]]$pif)
## ylds scenario
non_disease_list[[index]][paste0("ylds_rate_sc_", disease_short_names$acronym[d])] <-
non_disease_list[[index]][paste0("ylds_rate_", disease_short_names$acronym[d])] * (1 - pifs_no_disease_ylds[[index]]$pif)
## Difference variable
## deaths difference
non_disease_list[[index]][paste0("deaths_rate_diff_", disease_short_names$acronym[d])] <- non_disease_list[[index]][paste0("deaths_rate_", disease_short_names$acronym[d])] -
non_disease_list[[index]][paste0("deaths_rate_sc_", disease_short_names$acronym[d])]
## ylds difference
non_disease_list[[index]][paste0("ylds_rate_diff_", disease_short_names$acronym[d])] <- non_disease_list[[index]][paste0("ylds_rate_", disease_short_names$acronym[d])] -
non_disease_list[[index]][paste0("ylds_rate_sc_", disease_short_names$acronym[d])]
names(non_disease_list)[index] <- paste(iage, isex, disease_short_names$acronym[d], sep = "_")
index <- index + 1
}
}
}
}
disease_life_table_list_sc <- list()
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
for (d in 1:nrow(disease_short_names)){
## Exclude non-males diseases and non-chronic diseases and road injuries and disease with no pif
if (isex == "male" && (disease_short_names$disease[d] %in% c("breast cancer", "uterine cancer"))
|| disease_short_names$is_not_dis[d] != 0 || disease_short_names$acronym[d] == "no_pif" || disease_short_names$acronym[d] == "other"){
}
else {
# print(paste(isex, disease_short_names$disease[d]))
td1 <- mslt_df
pif_disease <- filter(pif_expanded, age >= iage & sex == isex) %>%
select(age, sex, contains(disease_short_names$acronym[disease_short_names$sname == disease_short_names$sname[d]]))
#[td1$age >= i_age_cohort & td1$sex == i_sex,]
td1[td1$age >= iage & td1$sex == isex,][[paste("incidence", disease_short_names$sname[d], sep = "_")]] <-
td1[td1$age >= iage & td1$sex == isex,][[paste("incidence", disease_short_names$sname[d], sep = "_")]] * (1 - (pif_disease %>% as.data.frame())[,3])
td1[is.na(td1)] <- 0
# # Instead of idata, feed td to run scenarios
disease_life_table_list_sc[[index]] <- RunDisease(in_idata = td1, in_sex = isex,
in_mid_age = iage, in_disease = disease_short_names$sname[d])
names(disease_life_table_list_sc)[index] <- paste(age, sex, disease_short_names$sname[d], sep = "_")
disease_life_table_list_sc[[index]]$diff_inc_disease <-
disease_life_table_list_sc[[index]]$incidence_disease -   disease_life_table_list_bl[[index]]$incidence_disease
disease_life_table_list_sc[[index]]$diff_prev_disease <-
disease_life_table_list_sc[[index]]$px  - disease_life_table_list_bl[[index]]$px
disease_life_table_list_sc[[index]]$diff_mort_disease <-
disease_life_table_list_sc[[index]]$mx - disease_life_table_list_bl[[index]]$mx
disease_life_table_list_sc[[index]]$diff_pylds_disease <-
(disease_life_table_list_sc[[index]]$px - disease_life_table_list_bl[[index]]$px) * disease_life_table_list_bl[[index]]$dw_disease
index <- index + 1
}
}
}
}
mx_sc_total <- list()
l_index <- 1
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
mortality_sum <- NULL
create_new <- T
for (d in 1:nrow(disease_short_names)) {
if (isex == "male" && (disease_short_names$disease[d] %in% c("breast cancer", "uterine cancer"))
|| disease_short_names$is_not_dis[d] != 0 || disease_short_names$acronym[d] == "no_pif" || disease_short_names$acronym[d] == "other"){
}
else {
# print(paste(isex, disease_short_names$disease[d]))
if (create_new){
mortality_sum <- select(disease_life_table_list_sc[[index]],
c('age', 'sex'))
mortality_sum$total <- 0
create_new <- F
mortality_sum$total <- mortality_sum$total +
(disease_life_table_list_sc[[index]]$diff_mort_disease)
}else{
mortality_sum$total <- mortality_sum$total +
(disease_life_table_list_sc[[index]]$diff_mort_disease)
}
# cat(age, " - ", sex," - ",  disease," - ",  index, " - ", l_index,  "\n")
index <- index + 1
}
}
mx_sc_total[[l_index]] <- mortality_sum
l_index <- l_index + 1
}
}
## Uncommnet to check sceanrio mortality and changes
# View(mx_sc_total[[16]])
## Generate total change in prevalent yld rates
## Total ylds rate= sum (change prevalence disease*dw)
pylds_sc_total <- list()
l_index <- 1
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
pylds_sum <- NULL
create_new <- T
for (d in 1:nrow(disease_short_names)) {
if (isex == "male" && (disease_short_names$disease[d] %in% c("breast cancer", "uterine cancer"))
|| disease_short_names$is_not_dis[d] != 0 || disease_short_names$acronym[d] == "no_pif" || disease_short_names$acronym[d] == "other"){
}
else {
# print(paste(isex, disease_short_names$disease[d]))
if (create_new){
pylds_sum <- select(disease_life_table_list_sc[[index]], c('age', 'sex'))
pylds_sum$total <- 0
create_new <- F
pylds_sum$total <- pylds_sum$total +
(disease_life_table_list_sc[[index]]$diff_pylds_disease)
}else{
pylds_sum$total <- pylds_sum$total +
(disease_life_table_list_sc[[index]]$diff_pylds_disease)
}
# cat(age, " - ", sex," - ",  disease," - ",  index, " - ", l_index,  "\n")
index <- index + 1
}
}
pylds_sc_total[[l_index]] <- pylds_sum
l_index <- l_index + 1
}
}
general_life_table_list_sc <- list()
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
# cat("age ", age, " and sex ", sex, "\n")
# modify idata's mortality and pyld total for the said scenario
td2 <- mslt_df
# td2 <- subset(td2, select = -c(mx, pyld_rate))
td2[td2$age >= iage & td2$sex == isex,][[paste("mx")]] <- general_life_table_list_bl[[index]]$mx + mx_sc_total[[index]]$total
td2[td2$age >= iage & td2$sex == isex,][[paste("pyld_rate")]] <- general_life_table_list_bl[[index]]$pyld_rate + pylds_sc_total[[index]]$total
# Instead of idata, feed td to run scenarios
general_life_table_list_sc[[index]] <- RunLifeTable(in_idata = td2, in_sex = isex, in_mid_age = iage)
#
index <- index + 1
}
}
warnings
warnings()
output_burden <- list()
l_index <- 1
index <- 1
for (iage in i_age_cohort){
for (isex in i_sex){
# Males do not have breast cancer, that is why we need the if/else.
# We create a TRUE/FALSE variable for the loop to move into the next disease
create_new <- T
for (d in 1:nrow(disease_short_names)) {
if (isex == "male" && (disease_short_names$disease[d] %in% c("breast cancer", "uterine cancer"))
|| disease_short_names$is_not_dis[d] != 0 || disease_short_names$acronym[d] == "no_pif" || disease_short_names$acronym[d] == "other"){
}
else {
if (create_new){
output_burden_sc <- select(disease_life_table_list_sc[[index]],
c('age', 'sex', 'incidence_disease', 'mx', 'px'))
names(output_burden_sc)[names(output_burden_sc) == 'incidence_disease'] <-
paste('incidence_disease', disease_short_names$sname[d], "sc", sep = "_")
names(output_burden_sc)[names(output_burden_sc) == 'mx'] <-
paste('mx', disease_short_names$sname[d], "sc", sep = "_")
names(output_burden_sc)[names(output_burden_sc) == 'px'] <-
paste('px', disease_short_names$sname[d], "sc", sep = "_")
output_burden_bl <- select(disease_life_table_list_bl[[index]],
c('incidence_disease', 'mx', 'px'))
names(output_burden_bl)[names(output_burden_bl) == 'incidence_disease'] <-
paste('incidence_disease', disease_short_names$sname[d], "bl", sep = "_")
names(output_burden_bl)[names(output_burden_bl) == 'mx'] <-
paste('mx', disease_short_names$sname[d], "bl", sep = "_")
names(output_burden_bl)[names(output_burden_bl) == 'px'] <-
paste('px', disease_short_names$sname[d], "bl", sep = "_")
## New list to add calculations for changes in burden of disease (incidence and mortality numbers)
output_burden_change <- list()
output_burden_change$inc_num_bl <- disease_life_table_list_bl[[index]]$incidence_disease *
(1 - disease_life_table_list_bl[[index]]$px) * general_life_table_list_bl[[l_index]]$Lx
output_burden_change$inc_num_sc <- disease_life_table_list_sc[[index]]$incidence_disease *
(1 - disease_life_table_list_sc[[index]]$px) * general_life_table_list_sc[[l_index]]$Lx
output_burden_change$inc_num_diff <- (disease_life_table_list_sc[[index]]$incidence_disease *
(1 - disease_life_table_list_sc[[index]]$px) * general_life_table_list_sc[[l_index]]$Lx) - (disease_life_table_list_bl[[index]]$incidence_disease * (1 - disease_life_table_list_bl[[index]]$px)
* general_life_table_list_bl[[l_index]]$Lx)
output_burden_change$mx_num_bl <- disease_life_table_list_bl[[index]]$mx * general_life_table_list_bl[[l_index]]$Lx
output_burden_change$mx_num_sc <- disease_life_table_list_sc[[index]]$mx * general_life_table_list_sc[[l_index]]$Lx
output_burden_change$mx_num_diff <- (disease_life_table_list_sc[[index]]$mx * general_life_table_list_sc[[l_index]]$Lx) - (disease_life_table_list_bl[[index]]$mx * general_life_table_list_bl[[l_index]]$Lx)
names(output_burden_change)[names(output_burden_change) == 'inc_num_bl'] <-
paste('inc_num_bl', disease_short_names$sname[d], sep = "_")
names(output_burden_change)[names(output_burden_change) == 'inc_num_sc'] <-
paste('inc_num_sc', disease_short_names$sname[d], sep = "_")
names(output_burden_change)[names(output_burden_change) == 'inc_num_diff'] <-
paste('inc_num_diff', disease_short_names$sname[d], sep = "_")
names(output_burden_change)[names(output_burden_change) == 'mx_num_bl'] <-
paste('mx_num_bl', disease_short_names$sname[d], sep = "_")
names(output_burden_change)[names(output_burden_change) == 'mx_num_sc'] <-
paste('mx_num_sc', disease_short_names$sname[d], sep = "_")
names(output_burden_change)[names(output_burden_change) == 'mx_num_diff'] <-
paste('mx_num_diff', disease_short_names$sname[d], sep = "_")
## Bind all lists
output_burden_sc <- cbind(output_burden_sc, output_burden_bl)
output_burden_sc <- cbind(output_burden_sc, output_burden_change)
create_new <- F
## Here the calculations above are repeated, here is where the F is telling to move into the next disease
}else{
td3 <- select(disease_life_table_list_sc[[index]],
c('incidence_disease', 'mx', 'px'))
names(td3)[names(td3) == 'incidence_disease'] <-
paste('incidence_disease', disease_short_names$sname[d], "sc", sep = "_")
names(td3)[names(td3) == 'mx'] <-
paste('mx', disease_short_names$sname[d], "sc", sep = "_")
names(td3)[names(td3) == 'px'] <-
paste('px', disease_short_names$sname[d], "sc", sep = "_")
td4 <- select(disease_life_table_list_bl[[index]],
c('incidence_disease', 'mx', 'px'))
names(td4)[names(td4) == 'incidence_disease'] <-
paste('incidence_disease', disease_short_names$sname[d], "bl", sep = "_")
names(td4)[names(td4) == 'mx'] <-
paste('mx', disease_short_names$sname[d], "bl", sep = "_")
names(td4)[names(td4) == 'px'] <-
paste('px', disease_short_names$sname[d], "bl", sep = "_")
output_burden_change2 <- list()
output_burden_change2$inc_num_bl <- disease_life_table_list_bl[[index]]$incidence_disease * (1 - disease_life_table_list_bl[[index]]$px) * general_life_table_list_bl[[l_index]]$Lx
output_burden_change2$inc_num_sc <- disease_life_table_list_sc[[index]]$incidence_disease * (1 - disease_life_table_list_sc[[index]]$px) * general_life_table_list_sc[[l_index]]$Lx
output_burden_change2$inc_num_diff <- (disease_life_table_list_sc[[index]]$incidence_disease * (1 - disease_life_table_list_sc[[index]]$px) * general_life_table_list_sc[[l_index]]$Lx) - (disease_life_table_list_bl[[index]]$incidence_disease * (1 - disease_life_table_list_bl[[index]]$px) * general_life_table_list_bl[[l_index]]$Lx)
output_burden_change2$mx_num_bl <- disease_life_table_list_bl[[index]]$mx * general_life_table_list_bl[[l_index]]$Lx
output_burden_change2$mx_num_sc <- disease_life_table_list_sc[[index]]$mx * general_life_table_list_sc[[l_index]]$Lx
output_burden_change2$mx_num_diff <- (disease_life_table_list_sc[[index]]$mx * general_life_table_list_sc[[l_index]]$Lx) - (disease_life_table_list_bl[[index]]$mx * general_life_table_list_bl[[l_index]]$Lx)
names(output_burden_change2)[names(output_burden_change2) == 'inc_num_bl'] <-
paste('inc_num_bl', disease_short_names$sname[d], sep = "_")
names(output_burden_change2)[names(output_burden_change2) == 'inc_num_sc'] <-
paste('inc_num_sc', disease_short_names$sname[d], sep = "_")
names(output_burden_change2)[names(output_burden_change2) == 'inc_num_diff'] <-
paste('inc_num_diff', disease_short_names$sname[d], sep = "_")
names(output_burden_change2)[names(output_burden_change2) == 'mx_num_bl'] <-
paste('mx_num_bl', disease_short_names$sname[d], sep = "_")
names(output_burden_change2)[names(output_burden_change2) == 'mx_num_sc'] <-
paste('mx_num_sc', disease_short_names$sname[d], sep = "_")
names(output_burden_change2)[names(output_burden_change2) == 'mx_num_diff'] <-
paste('mx_num_diff', disease_short_names$sname[d], sep = "_")
## Bind all lists
output_burden_sc <- cbind(output_burden_sc, td3)
output_burden_sc <- cbind(output_burden_sc, td4)
output_burden_sc$age_cohort <- age
output_burden_sc <- cbind(output_burden_sc, output_burden_change2)
}
# cat(age, " - ", sex," - ",  disease," - ",  index, " - ", l_index,  "\n")
index <- index + 1
}
}
## general_life_table_list_sc and general_life_table_list_bl (Lx)
output_burden_lf_sc <- select(general_life_table_list_sc[[l_index]], c('Lx', 'Lwx'))
names(output_burden_lf_sc)[names(output_burden_lf_sc) == 'Lx'] <- paste('Lx', "sc", sep = "_")
names(output_burden_lf_sc)[names(output_burden_lf_sc) == 'Lwx'] <- paste('Lwx', "sc", sep = "_")
output_burden_lf_bl <- select(general_life_table_list_bl[[l_index]], c('Lx', 'Lwx'))
names(output_burden_lf_bl)[names(output_burden_lf_bl) == 'Lx'] <- paste('Lx', "bl", sep = "_")
names(output_burden_lf_bl)[names(output_burden_lf_bl) == 'Lwx'] <- paste('Lwx', "bl", sep = "_")
output_burden_lf_sc$Lx_diff <- general_life_table_list_bl[[l_index]]$Lx - general_life_table_list_sc[[l_index]]$Lx
output_burden_lf_sc$Lwx_diff <- general_life_table_list_bl[[l_index]]$Lwx - general_life_table_list_sc[[l_index]]$Lwx
output_burden_sc <- cbind(output_burden_sc, output_burden_lf_sc)
output_burden_sc <- cbind(output_burden_sc, output_burden_lf_bl)
output_burden[[l_index]] <- output_burden_sc
l_index <- l_index + 1
}
}
output_df <- plyr::ldply(output_burden, rbind)
View(output_df)
